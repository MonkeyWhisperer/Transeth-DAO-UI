{"version":3,"sources":["../../../src/rpc/handlers/describe-script.js"],"names":["request","proxy","wrapper","script","params","describedPath","describeTransactionPath","decodeTransactionPath","identifiers","appIdentifiers","pipe","toPromise","Promise","all","map","step","app","getApp","to","identifier","name"],"mappings":"oJA6duB;46BA3dR,wBAAgBA,OAAhB,CAAyBC,KAAzB,CAAgCC,OAAhC,CAAyC,MAChDC,CAAAA,MAAM,CAAGH,OAAO,CAACI,MAAR,CAAe,CAAf,CADuC,CAGhDC,aAAa,CAAG,KAAMH,CAAAA,OAAO,CAACI,uBAAR,CAC1BJ,OAAO,CAACK,qBAAR,CAA8BJ,MAA9B,CAD0B,CAH0B,CAUhDK,WAAW,CAAG,KAAMN,CAAAA,OAAO,CAACO,cAAR,CAAuBC,IAAvB,CAA4B,sBAA5B,EAAqCC,SAArC,EAV4B,CAWtD,MAAOC,CAAAA,OAAO,CAACC,GAAR,CACLR,aAAa,CAACS,GAAd,CAAkB,KAAOC,CAAAA,IAAP,EAAgB,CAChC,KAAMC,CAAAA,GAAG,CAAG,KAAMd,CAAAA,OAAO,CAACe,MAAR,CAAeF,IAAI,CAACG,EAApB,CAAlB,CADgC,MAG5BF,CAAAA,GAH4B,gCAKzBD,IALyB,MAM5BI,UAAU,CAAEX,WAAW,CAACO,IAAI,CAACG,EAAN,CANK,CAO5BE,IAAI,CAAEJ,GAAG,CAACI,IAPkB,GAWzBL,IACR,CAZD,CADK,CAeR","sourcesContent":["import { first } from 'rxjs/operators'\n\nexport default async function (request, proxy, wrapper) {\n  const script = request.params[0]\n\n  const describedPath = await wrapper.describeTransactionPath(\n    wrapper.decodeTransactionPath(script)\n  )\n\n  // Add name and identifier decoration\n  // TODO: deprecate this now that the app has enough information to get this information itself\n  // through getApps()\n  const identifiers = await wrapper.appIdentifiers.pipe(first()).toPromise()\n  return Promise.all(\n    describedPath.map(async (step) => {\n      const app = await wrapper.getApp(step.to)\n\n      if (app) {\n        return {\n          ...step,\n          identifier: identifiers[step.to],\n          name: app.name\n        }\n      }\n\n      return step\n    })\n  )\n}\n"],"file":"describe-script.js"}