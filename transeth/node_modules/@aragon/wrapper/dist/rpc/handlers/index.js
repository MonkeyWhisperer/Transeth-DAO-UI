"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0// force cache invalidation
}),exports.createResponse=createResponse,exports.createRequestHandler=createRequestHandler,exports.combineRequestHandlers=combineRequestHandlers,Object.defineProperty(exports,"accounts",{enumerable:!0,get:function(){return _accounts.default}}),Object.defineProperty(exports,"cache",{enumerable:!0,get:function(){return _cache.default}}),Object.defineProperty(exports,"describeScript",{enumerable:!0,get:function(){return _describeScript.default}}),Object.defineProperty(exports,"describeTransaction",{enumerable:!0,get:function(){return _describeTransaction.default}}),Object.defineProperty(exports,"getApps",{enumerable:!0,get:function(){return _getApps.default}}),Object.defineProperty(exports,"network",{enumerable:!0,get:function(){return _network.default}}),Object.defineProperty(exports,"path",{enumerable:!0,get:function(){return _path.default}}),Object.defineProperty(exports,"guiStyle",{enumerable:!0,get:function(){return _guiStyle.default}}),Object.defineProperty(exports,"trigger",{enumerable:!0,get:function(){return _trigger.default}}),Object.defineProperty(exports,"web3Eth",{enumerable:!0,get:function(){return _web3Eth.default}}),Object.defineProperty(exports,"intent",{enumerable:!0,get:function(){return _intent.default}}),Object.defineProperty(exports,"call",{enumerable:!0,get:function(){return _call.default}}),Object.defineProperty(exports,"signMessage",{enumerable:!0,get:function(){return _signMessage.default}}),Object.defineProperty(exports,"events",{enumerable:!0,get:function(){return _events.default}}),Object.defineProperty(exports,"pastEvents",{enumerable:!0,get:function(){return _pastEvents.default}}),Object.defineProperty(exports,"externalIntent",{enumerable:!0,get:function(){return _external.intent}}),Object.defineProperty(exports,"externalCall",{enumerable:!0,get:function(){return _external.call}}),Object.defineProperty(exports,"externalEvents",{enumerable:!0,get:function(){return _external.events}}),Object.defineProperty(exports,"externalPastEvents",{enumerable:!0,get:function(){return _external.pastEvents}}),Object.defineProperty(exports,"addressIdentity",{enumerable:!0,get:function(){return _addressIdentity.default}}),Object.defineProperty(exports,"appIdentifier",{enumerable:!0,get:function(){return _appIdentifier.default}}),Object.defineProperty(exports,"searchIdentities",{enumerable:!0,get:function(){return _searchIdentities.default}});var _rxjs=require("rxjs"),_operators=require("rxjs/operators"),_rpcMessenger=require("@aragon/rpc-messenger"),_accounts=_interopRequireDefault(require("./accounts")),_cache=_interopRequireDefault(require("./cache")),_describeScript=_interopRequireDefault(require("./describe-script")),_describeTransaction=_interopRequireDefault(require("./describe-transaction")),_getApps=_interopRequireDefault(require("./get-apps")),_network=_interopRequireDefault(require("./network")),_path=_interopRequireDefault(require("./path")),_guiStyle=_interopRequireDefault(require("./gui-style")),_trigger=_interopRequireDefault(require("./trigger")),_web3Eth=_interopRequireDefault(require("./web3-eth")),_intent=_interopRequireDefault(require("./intent")),_call=_interopRequireDefault(require("./call")),_signMessage=_interopRequireDefault(require("./sign-message")),_events=_interopRequireDefault(require("./events")),_pastEvents=_interopRequireDefault(require("./past-events")),_external=require("./external"),_addressIdentity=_interopRequireDefault(require("./address-identity")),_appIdentifier=_interopRequireDefault(require("./app-identifier")),_searchIdentities=_interopRequireDefault(require("./search-identities"));function createResponse({request:{id}},{error,value=null,kind}){return"C"===kind?{id,payload:_rpcMessenger.signals.COMPLETE}:"E"===kind?{id,payload:error||new Error}:{id,payload:value}}function createRequestHandler(request$,requestType,handler){// Filter request types to match provided params
const filteredRequest$=request$.pipe((0,_operators.filter)(({request})=>request.method===requestType));// Send request to handler and return response
return filteredRequest$.pipe(/**
     * Turn the promise returned by the handler into an observable and materialize it, i.e:
     * - if the observable emits, emit a Notification of kind 'N' (next) with a value property
     * - if the observable rejects, emit a Notification of kind 'E' with an error property
     * - if the observable completes, emit a Notification of kind 'C' (complete)
     */(0,_operators.mergeMap)(({request,proxy,wrapper})=>(0,_rxjs.from)(handler(request,proxy,wrapper)).pipe((0,_operators.materialize)()),createResponse),// TODO: instead of filtering, log if a payload is undefined
(0,_operators.filter)(response=>response.payload!==void 0))}function combineRequestHandlers(...handlers){return(0,_rxjs.merge)(...handlers)}// Export request handlers
//# sourceMappingURL=index.js.map