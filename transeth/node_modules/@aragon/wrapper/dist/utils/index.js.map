{"version":3,"file":"index.js","names":["ANY_ENTITY","addressesEqual","first","second","toLowerCase","includesAddress","arr","address","some","a","makeAddressMapProxy","target","targetLowerCaseKeys","Object","entries","forEach","val","Proxy","get","property","isAddress","set","value","getCacheKey","location","makeProxy","interfaceName","web3","options","abi","getAbi","makeProxyFromABI","appProxyEventsAbi","filter","type","makeProxyFromAppABI","appAbi","appAbiWithProxyEvents","concat","ContractProxy"],"sources":["../../src/utils/index.js"],"sourcesContent":["import { isAddress } from 'web3-utils'\nimport ContractProxy from '../core/proxy'\nimport { getAbi } from '../interfaces'\n\nexport const ANY_ENTITY = '0xFFfFfFffFFfffFFfFFfFFFFFffFFFffffFfFFFfF'\n\n// Check address equality without checksums\nexport function addressesEqual (first, second) {\n  first = first && first.toLowerCase()\n  second = second && second.toLowerCase()\n  return first === second\n}\n\n// \"Safer\" version of [].includes() for addresses\nexport function includesAddress (arr, address) {\n  return arr.some(a => addressesEqual(a, address))\n}\n\n// Address map that ensures consistent non-checksummed interpretations of addresses\nexport function makeAddressMapProxy (target = {}) {\n  const targetLowerCaseKeys = {}\n  Object.entries(target).forEach(([address, val]) => {\n    targetLowerCaseKeys[address.toLowerCase()] = val\n  })\n\n  return new Proxy(targetLowerCaseKeys, {\n    get (target, property, receiver) {\n      if (property in target) {\n        return target[property]\n      }\n\n      if (typeof property === 'string' && isAddress(property)) {\n        // Our set handler will ensure any addresses are stored in all lowercase\n        return target[property.toLowerCase()]\n      }\n    },\n    set (target, property, value, receiver) {\n      if (typeof property === 'string' && isAddress(property)) {\n        target[property.toLowerCase()] = value\n      } else {\n        target[property] = value\n      }\n      return true\n    }\n  })\n}\n\n/**\n * Get a standard cache key\n *\n * @param {string} address\n * @param {string} location\n */\nexport function getCacheKey (address, location) {\n  return `${address}.${location}`\n}\n\nexport function makeProxy (address, interfaceName, web3, options) {\n  const abi = getAbi(`aragon/${interfaceName}`)\n  return makeProxyFromABI(address, abi, web3, options)\n}\n\nconst appProxyEventsAbi = getAbi('aragon/AppProxy').filter(({ type }) => type === 'event')\nexport function makeProxyFromAppABI (address, appAbi, web3, options) {\n  const appAbiWithProxyEvents = [].concat(appAbi, appProxyEventsAbi)\n  return makeProxyFromABI(address, appAbiWithProxyEvents, web3, options)\n}\n\nexport function makeProxyFromABI (address, abi, web3, options) {\n  return new ContractProxy(address, abi, web3, options)\n}\n\nexport { default as AsyncRequestCache } from './AsyncRequestCache'\n"],"mappings":"oJAqeuB;knBAjehB,KAAMA,WAAU,CAAG,4CAAnB,CAEP;gEACO,QAASC,eAAT,CAAyBC,KAAzB,CAAgCC,MAAhC,CAAwC,CAG7C,MAFAD,MAAK,CAAGA,KAAK,EAAIA,KAAK,CAACE,WAAN,EAEjB,CADAD,MAAM,CAAGA,MAAM,EAAIA,MAAM,CAACC,WAAP,EACnB,CAAOF,KAAK,GAAKC,MAClB,CAED;AACO,QAASE,gBAAT,CAA0BC,GAA1B,CAA+BC,OAA/B,CAAwC,CAC7C,MAAOD,IAAG,CAACE,IAAJ,CAASC,CAAC,EAAIR,cAAc,CAACQ,CAAD,CAAIF,OAAJ,CAA5B,CACR,CAED;AACO,QAASG,oBAAT,EAA2C,IAAbC,OAAa,wDAAJ,EAAI,CAChD,KAAMC,oBAAmB,CAAG,EAA5B,CAKA,MAJAC,OAAM,CAACC,OAAP,CAAeH,MAAf,EAAuBI,OAAvB,CAA+B,MAAoB,IAAnB,CAACR,OAAD,CAAUS,GAAV,CAAmB,MACjDJ,mBAAmB,CAACL,OAAO,CAACH,WAAR,EAAD,CAAnB,CAA6CY,GAC9C,CAFD,CAIA,CAAO,GAAIC,MAAJ,CAAUL,mBAAV,CAA+B,CACpCM,GAAG,CAAEP,MAAF,CAAUQ,QAAV,CAA8B,OAC3BA,SAAQ,GAAIR,OADe,CAEtBA,MAAM,CAACQ,QAAD,CAFgB,CAKP,QAApB,QAAOA,SAAP,EAAgC,GAAAC,oBAAA,EAAUD,QAAV,CALL,CAOtBR,MAAM,CAACQ,QAAQ,CAACf,WAAT,EAAD,CAPgB,OAShC,CAVmC,CAWpCiB,GAAG,CAAEV,MAAF,CAAUQ,QAAV,CAAoBG,KAApB,CAAqC,CAMtC,MALwB,QAApB,QAAOH,SAAP,EAAgC,GAAAC,oBAAA,EAAUD,QAAV,CAKpC,CAJER,MAAM,CAACQ,QAAQ,CAACf,WAAT,EAAD,CAAN,CAAiCkB,KAInC,CAFEX,MAAM,CAACQ,QAAD,CAAN,CAAmBG,KAErB,GACD,CAlBmC,CAA/B,CAoBR,CAED;AACA;AACA;AACA;AACA;AACA,GACO,QAASC,YAAT,CAAsBhB,OAAtB,CAA+BiB,QAA/B,CAAyC,CAC9C,MAAQ,GAAEjB,OAAQ,IAAGiB,QAAS,EAC/B,CAEM,QAASC,UAAT,CAAoBlB,OAApB,CAA6BmB,aAA7B,CAA4CC,IAA5C,CAAkDC,OAAlD,CAA2D,CAChE,KAAMC,IAAG,CAAG,GAAAC,kBAAA,EAAQ,UAASJ,aAAc,EAA/B,CAAZ,CACA,MAAOK,iBAAgB,CAACxB,OAAD,CAAUsB,GAAV,CAAeF,IAAf,CAAqBC,OAArB,CACxB,CAED,KAAMI,kBAAiB,CAAG,GAAAF,kBAAA,EAAO,iBAAP,EAA0BG,MAA1B,CAAiC,WAAC,CAAEC,IAAF,CAAD,aAAuB,OAAT,GAAAA,IAAd,CAAjC,CAA1B,CACO,QAASC,oBAAT,CAA8B5B,OAA9B,CAAuC6B,MAAvC,CAA+CT,IAA/C,CAAqDC,OAArD,CAA8D,CACnE,KAAMS,sBAAqB,CAAG,GAAGC,MAAH,CAAUF,MAAV,CAAkBJ,iBAAlB,CAA9B,CACA,MAAOD,iBAAgB,CAACxB,OAAD,CAAU8B,qBAAV,CAAiCV,IAAjC,CAAuCC,OAAvC,CACxB,CAEM,QAASG,iBAAT,CAA2BxB,OAA3B,CAAoCsB,GAApC,CAAyCF,IAAzC,CAA+CC,OAA/C,CAAwD,CAC7D,MAAO,IAAIW,eAAJ,CAAkBhC,OAAlB,CAA2BsB,GAA3B,CAAgCF,IAAhC,CAAsCC,OAAtC,CACR"}