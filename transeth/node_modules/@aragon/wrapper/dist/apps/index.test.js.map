{"version":3,"file":"index.test.js","names":["test","t","pool","AppContextPool","false","hasApp","get","APP_CONTEXTS","PATH","true","emit","context","counter","subscribe","val","is","fail","TRIGGER","event","deepEqual","returnValues"],"sources":["../../src/apps/index.test.js"],"sourcesContent":["import test from 'ava'\nimport AppContextPool, { APP_CONTEXTS } from './index'\n\ntest('AppContextPool starts empty', async (t) => {\n  // arrange\n  const appAddress = '0x12'\n  const pool = new AppContextPool()\n  // assert\n  t.false(pool.hasApp(appAddress))\n})\n\ntest('AppContextPool can create new app context when retrieving a context for first time', async (t) => {\n  // arrange\n  const appAddress = '0x12'\n  const pool = new AppContextPool()\n  t.false(pool.hasApp(appAddress))\n  // act\n  pool.get(appAddress, APP_CONTEXTS.PATH)\n  // assert\n  t.true(pool.hasApp(appAddress))\n})\n\ntest('AppContextPool can create new app context when emitting initial value', async (t) => {\n  // arrange\n  const appAddress = '0x12'\n  const pool = new AppContextPool()\n  t.false(pool.hasApp(appAddress))\n  // act\n  pool.emit(appAddress, APP_CONTEXTS.PATH, '/vote')\n  // assert\n  t.true(pool.hasApp(appAddress))\n})\n\ntest('AppContextPool can read and write values to path context', async (t) => {\n  // arrange\n  const appAddress = '0x12'\n  const pool = new AppContextPool()\n  // assert\n  const context = pool.get(appAddress, APP_CONTEXTS.PATH)\n  let counter = 0\n  context.subscribe(val => {\n    if (counter === 0) {\n      t.is(val, null)\n    } else if (counter === 1) {\n      t.is(val, '/first')\n    } else if (counter === 2) {\n      t.is(val, '/second')\n    } else {\n      t.fail('too many emissions')\n    }\n    counter++\n  })\n  // act\n  pool.emit(appAddress, APP_CONTEXTS.PATH, '/first')\n  pool.emit(appAddress, APP_CONTEXTS.PATH, '/second')\n})\n\ntest('AppContextPool can read and write values to trigger context', async (t) => {\n  // arrange\n  const appAddress = '0x12'\n  const pool = new AppContextPool()\n  // assert\n  const context = pool.get(appAddress, APP_CONTEXTS.TRIGGER)\n  let counter = 0\n  context.subscribe(val => {\n    if (counter === 0) {\n      t.is(val.event, 'first')\n      t.deepEqual(val.returnValues, {})\n    } else if (counter === 1) {\n      t.is(val.event, 'second')\n      t.deepEqual(val.returnValues, {})\n    } else {\n      t.fail('too many emissions')\n    }\n    counter++\n  })\n  // act\n  pool.emit(appAddress, APP_CONTEXTS.TRIGGER, { event: 'first', returnValues: {} })\n  pool.emit(appAddress, APP_CONTEXTS.TRIGGER, { event: 'second', returnValues: {} })\n})\n"],"mappings":"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"}