{"version":3,"file":"kernel.js","names":["SET_APP_ABI","name","type","CORE_NAMESPACE","soliditySha3","APP_ADDR_NAMESPACE","APP_BASES_NAMESPACE","KERNEL_NAMESPACES_NAMES","Map","decodeKernelSetAppParameters","data","paramData","substring","abi","decodeParameters","getKernelNamespace","hash","has","get","isKernelAppCodeNamespace","namespaceHash","isKernelSetAppIntent","kernelApp","intent","addressesEqual","proxyAddress","to","method","findAppMethodFromData","sig"],"sources":["../../../src/core/aragonOS/kernel.js"],"sourcesContent":["import abi from 'web3-eth-abi'\nimport { soliditySha3 } from 'web3-utils'\n\nimport { addressesEqual } from '../../utils'\nimport { findAppMethodFromData } from '../../utils/apps'\n\nconst SET_APP_ABI = [\n  { name: 'namespace', type: 'bytes32' },\n  { name: 'appId', type: 'bytes32' },\n  { name: 'appAddress', type: 'address' }\n]\n\nconst CORE_NAMESPACE = soliditySha3('core')\nconst APP_ADDR_NAMESPACE = soliditySha3('app')\nconst APP_BASES_NAMESPACE = soliditySha3('base')\nconst KERNEL_NAMESPACES_NAMES = new Map([\n  [CORE_NAMESPACE, 'Core'],\n  [APP_ADDR_NAMESPACE, 'Default apps'],\n  [APP_BASES_NAMESPACE, 'App code']\n])\n\n/**\n * Decode `Kernel.setApp()` parameters based on transaction data.\n *\n * @param  {Object} data Transaction data\n * @return {Object} Decoded parameters for `setApp()` (namespace, appId, appAddress)\n */\nexport function decodeKernelSetAppParameters (data) {\n  // Strip 0x prefix + bytes4 sig to get parameter data\n  const paramData = data.substring(10)\n  return abi.decodeParameters(SET_APP_ABI, paramData)\n}\n\nexport function getKernelNamespace (hash) {\n  return KERNEL_NAMESPACES_NAMES.has(hash)\n    ? { name: KERNEL_NAMESPACES_NAMES.get(hash), hash }\n    : null\n}\n\nexport function isKernelAppCodeNamespace (namespaceHash) {\n  return namespaceHash === APP_BASES_NAMESPACE\n}\n\n/**\n * Is the transaction intent for `Kernel.setApp()`?\n *\n * @param  {Object} kernelApp App artifact for Kernel\n * @param  {Object} intent Transaction intent\n * @return {Boolean} Whether the intent is `Kernel.setApp()`\n */\nexport function isKernelSetAppIntent (kernelApp, intent) {\n  if (!addressesEqual(kernelApp.proxyAddress, intent.to)) return false\n\n  const method = findAppMethodFromData(kernelApp, intent.data)\n  return !!method && method.sig === 'setApp(bytes32,bytes32,address)'\n}\n"],"mappings":"yhBAMMA,YAAW,CAAG,CAClB,CAAEC,IAAI,CAAE,WAAR,CAAqBC,IAAI,CAAE,SAA3B,CADkB,CAElB,CAAED,IAAI,CAAE,OAAR,CAAiBC,IAAI,CAAE,SAAvB,CAFkB,CAGlB,CAAED,IAAI,CAAE,YAAR,CAAsBC,IAAI,CAAE,SAA5B,CAHkB,C,CAMdC,cAAc,CAAG,GAAAC,uBAAA,EAAa,MAAb,C,CACjBC,kBAAkB,CAAG,GAAAD,uBAAA,EAAa,KAAb,C,CACrBE,mBAAmB,CAAG,GAAAF,uBAAA,EAAa,MAAb,C,CACtBG,uBAAuB,CAAG,GAAIC,IAAJ,CAAQ,CACtC,CAACL,cAAD,CAAiB,MAAjB,CADsC,CAEtC,CAACE,kBAAD,CAAqB,cAArB,CAFsC,CAGtC,CAACC,mBAAD,CAAsB,UAAtB,CAHsC,CAAR,C,CAMhC;AACA;AACA;AACA;AACA;AACA,GACO,QAASG,6BAAT,CAAuCC,IAAvC,CAA6C,CAClD;AACA,KAAMC,UAAS,CAAGD,IAAI,CAACE,SAAL,CAAe,EAAf,CAAlB,CACA,MAAOC,oBAAA,CAAIC,gBAAJ,CAAqBd,WAArB,CAAkCW,SAAlC,CACR,CAEM,QAASI,mBAAT,CAA6BC,IAA7B,CAAmC,CACxC,MAAOT,wBAAuB,CAACU,GAAxB,CAA4BD,IAA5B,EACH,CAAEf,IAAI,CAAEM,uBAAuB,CAACW,GAAxB,CAA4BF,IAA5B,CAAR,CAA2CA,IAA3C,CADG,CAEH,IACL,CAEM,QAASG,yBAAT,CAAmCC,aAAnC,CAAkD,CACvD,MAAOA,cAAa,GAAKd,mBAC1B,CAED;AACA;AACA;AACA;AACA;AACA;AACA,GACO,QAASe,qBAAT,CAA+BC,SAA/B,CAA0CC,MAA1C,CAAkD,CACvD,GAAI,CAAC,GAAAC,qBAAA,EAAeF,SAAS,CAACG,YAAzB,CAAuCF,MAAM,CAACG,EAA9C,CAAL,CAAwD,SAExD,KAAMC,OAAM,CAAG,GAAAC,2BAAA,EAAsBN,SAAtB,CAAiCC,MAAM,CAACb,IAAxC,CAAf,CACA,MAAO,CAAC,CAACiB,MAAF,EAA2B,iCAAf,GAAAA,MAAM,CAACE,GAC3B"}