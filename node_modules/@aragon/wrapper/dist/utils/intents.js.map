{"version":3,"file":"intents.js","names":["doIntentPathsMatch","intentPaths","individualPaths","map","path","to","slice","join","Set","size","filterAndDecodeAppUpgradeIntents","intents","wrapper","kernelApp","getApp","kernelProxy","address","filter","intent","isKernelSetAppIntent","decodeKernelSetAppParameters","data","_","namespace","isKernelAppCodeNamespace"],"sources":["../../src/utils/intents.js"],"sourcesContent":["import {\n  decodeKernelSetAppParameters,\n  isKernelAppCodeNamespace,\n  isKernelSetAppIntent\n} from '../core/aragonOS/kernel'\n\nexport function doIntentPathsMatch (intentPaths) {\n  const individualPaths = intentPaths\n    // Map each path to just be an array of destination addresses\n    .map(path =>\n      path.map(({ to }) => to)\n    )\n    // Ignore the final intent target, as the path is everything \"before\" that target\n    .map(path => path.slice(0, -1))\n    // Take each array of destination addresses and create a single string\n    .map(path => path.join('.'))\n\n  // Check if they all match by seeing if a unique set of the individual path\n  // strings is a single path\n  // Also make sure that there was indeed an actual path found\n  return (new Set(individualPaths)).size === 1 && Boolean(individualPaths[0])\n}\n\nexport async function filterAndDecodeAppUpgradeIntents (intents, wrapper) {\n  const kernelApp = await wrapper.getApp(wrapper.kernelProxy.address)\n\n  return intents\n    // Filter for setApp() calls to the kernel\n    .filter((intent) => isKernelSetAppIntent(kernelApp, intent))\n    // Try to decode setApp() params\n    .map((intent) => {\n      try {\n        return decodeKernelSetAppParameters(intent.data)\n      } catch (_) {}\n\n      return {}\n    })\n    // Filter for changes to APP_BASES_NAMESPACE\n    .filter(({ namespace }) => isKernelAppCodeNamespace(namespace))\n}\n"],"mappings":"aAAA,+C,oDAqeuB;2HA/dhB,QAASA,mBAAT,CAA6BC,WAA7B,CAA0C,CAC/C,KAAMC,gBAAe,CAAGD,WACtB;AADiC,CAEhCE,GAFqB,CAEjBC,IAAI,EACPA,IAAI,CAACD,GAAL,CAAS,UAAC,CAAEE,EAAF,CAAD,YAAYA,GAAZ,CAAT,CAHoB,CAKtB;AALsB,CAMrBF,GANqB,CAMjBC,IAAI,EAAIA,IAAI,CAACE,KAAL,CAAW,CAAX,CAAc,CAAC,CAAf,CANS,CAOtB;AAPsB,CAQrBH,GARqB,CAQjBC,IAAI,EAAIA,IAAI,CAACG,IAAL,CAAU,GAAV,CARS,CAAxB,CAUA;AACA;AACA;AACA,MAA2C,EAApC,GAAC,GAAIC,IAAJ,CAAQN,eAAR,CAAD,CAA2BO,IAA3B,IAAiDP,eAAe,CAAC,CAAD,CACxE,CAEM,cAAeQ,iCAAf,CAAiDC,OAAjD,CAA0DC,OAA1D,CAAmE,CACxE,KAAMC,UAAS,CAAG,KAAMD,QAAO,CAACE,MAAR,CAAeF,OAAO,CAACG,WAAR,CAAoBC,OAAnC,CAAxB,CAEA,MAAOL,QACL;AADY,CAEXM,MAFI,CAEIC,MAAD,EAAY,GAAAC,4BAAA,EAAqBN,SAArB,CAAgCK,MAAhC,CAFf,CAGL;AAHK,CAIJf,GAJI,CAICe,MAAD,EAAY,CACf,GAAI,CACF,MAAO,GAAAE,oCAAA,EAA6BF,MAAM,CAACG,IAApC,CACR,CAAC,MAAOC,CAAP,CAAU,CAAE,CAEd,MAAO,EACR,CAVI,CAWL;AAXK,CAYJL,MAZI,CAYG,WAAC,CAAEM,SAAF,CAAD,aAAmB,GAAAC,gCAAA,EAAyBD,SAAzB,CAAnB,CAZH,CAaR"}